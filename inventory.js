
function renderInv(){ const wrap=document.getElementById('invGrid'); const inv = JSON.parse(localStorage.getItem('rbx_inv')||'[]'); wrap.innerHTML=''; inv.forEach((it,idx)=>{ const card=document.createElement('div'); card.className='inv-item'; card.innerHTML = `<div>${it.name||it.case||'Кейс'}</div><div class="small">${it.rarity||''}</div><div style="margin-top:8px"><button class="btn openInvBtn" data-i="${idx}">${it.opened? 'Просмотр':'Открыть'}</button> <button class="btn ghost sellBtn" data-i="${idx}">Продать</button></div>`; wrap.appendChild(card); }); document.querySelectorAll('.openInvBtn').forEach(b=>b.addEventListener('click', e=>{ const i=e.target.dataset.i; const inv=JSON.parse(localStorage.getItem('rbx_inv')||'[]'); const it=inv[i]; if(it.case && !it.opened){ localStorage.setItem('open_case', it.case); inv.splice(i,1); localStorage.setItem('rbx_inv', JSON.stringify(inv)); location.href='case_open.html'; } else alert('Открыть нельзя'); })); document.querySelectorAll('.sellBtn').forEach(b=>b.addEventListener('click', e=>{ const i=e.target.dataset.i; const inv=JSON.parse(localStorage.getItem('rbx_inv')||'[]'); const it=inv[i]; const price= it.rarity==='legend'?5000: it.rarity==='epic'?2000: it.rarity==='rare'?500:100; let bal=Number(localStorage.getItem('rbx_balance')||0); bal+=price; localStorage.setItem('rbx_balance', bal); inv.splice(i,1); localStorage.setItem('rbx_inv', JSON.stringify(inv)); alert('Предмет продан за '+price+' Robux'); renderInv(); })); }
document.addEventListener('DOMContentLoaded', renderInv);
